---
- name: ğŸ’¥ğŸ’¥ğŸ’¥ Simulate a disaster! ğŸ’¥ğŸ’¥ğŸ’¥
  hosts: localhost
  gather_facts: False

  vars_files:
  - vault.yml
  - vars.yml

  collections:
  - ansible.controller

  tasks:
  - name: ğŸ§¨ Nuke the org ğŸ§¨
    ansible.controller.organization:
      name: "{{ customer }} org"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False

  - name: ğŸ§¨ Nuke the project ğŸ§¨
    ansible.controller.project:
      name: "{{ customer }} project"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False

  - name: ğŸ§¨ Nuke the job ğŸ§¨
    ansible.controller.job_template:
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False
      name: "{{ customer }} job"
      state: absent
